<import src="../../../component/wxParse/wxParse.wxml" xmlns:wx="http://www.w3.org/1999/xhtml"/>
<import src="../../../component/rater/rater.wxml"></import>

<view class="container">

    <!--header-->
    <view class="tui-header-box" style="height:{{height}}px;background:rgba(255,255,255,{{opcity}})">
        <view class="tui-header" style="padding-top:{{top}}px; opacity:{{opcity}};">

            <view class="tui-header-title-nav">
                {{navName}}
            </view>

        </view>
        <view class="tui-header-icon" style="margin-top:{{top}}px">
            <tui-icon name="arrowleft" color="{{opcity>=1?'#000':'#000'}}" bindtap="back" tui-icon-class="tui-icon-back" class="tui-icon" style="background:rgba(255, 255, 255, {{iconOpcity}});"></tui-icon>
            <tui-icon name="more-fill" color="{{opcity>=1?'#000':'#000'}}" size="20" tui-icon-class="tui-icon-more" class="tui-icon tui-icon-ml" style="background:rgba(255, 255, 255, {{iconOpcity}});" catchtap="openMenu"></tui-icon>
        </view>
    </view>
    <!--header-->

    <view id="detail" >




        <!--    作品基本信息-->
        <view class="top-box js__top">
            <!--banner-->
            <view class="tui-banner-swiper">
                <swiper autoplay="true" interval="9000" duration="150" circular="{{true}}" style="height:400px" bindchange="bannerChange">
                    <block wx:for="{{detailData.data.photos}}" wx:key="{{index}}">
                        <swiper-item data-index="{{index}}" catchtap="previewImage">
                            <image src="{{item.url}}" class="tui-slide-image" mode="aspectFill"  style="width: 100%;height: 400px;"  />
                        </swiper-item>
                    </block>
                </swiper>
                <tui-tag type="translucentWhite" tui-tag-class="tui-tag-banner" shape="circleLeft" size="small">
                    {{bannerIndex+1}}/{{detailData.data.photos.length}}
                </tui-tag>
            </view>

            <!--gINFO S-->
            <view class="goods-info">

                <view class="tui-pro-titbox">
                    <view class="f32">{{detailData.data.name}}</view>
                </view>


                <block wx:for="{{detailData.data.goodInfo||goodInfo}}" wx:key wx:for-index="idx" wx:for-item="itemGood">
                    <view style="display: flex;flex-direction: row;justify-content: space-between;align-items: center;height: 50rpx;" class="goods-characteristic">
                        <block wx:for="{{itemGood}}" wx:key>
                            <view class="f22">{{item}}</view>
                        </block>
                    </view>
                </block>




                <view style="display: flex;flex-direction: row;justify-content: space-between;align-items: center;padding: 0 30rpx">
                    <view style="color: #C9A063" class="f32">Ұ {{price}} <text class="f22" style="margin-left: 20rpx;text-decoration: line-through">Ұ {{detailData.data.market_price}}</text></view>
                    <view class="f22">包邮</view>
                </view>

            </view>
            <!--gINFO E-->

            <!--banner-->

            <view class="basic-information">
                <!--优惠券信息-->
                <view class="coupons-tags van-hairline--top" wx:if="{{coupons.length}}" bindtap="changeCoupons">
                    <view class="tags-title">
                        领券
                    </view>
                    <view class="coupon-box">
                        <view class="tags-item" wx:for="{{coupons}}" wx:key="{{index}}" wx:if="{{index <= 2 }}">
                            {{item.label}}

                            <view class="dot-wrap">
                                <view class="dot-left">
                                    <view class="dot-item dot-item-left"></view>
                                    <view class="dot-item dot-item-left"></view>
                                    <view class="dot-item dot-item-left"></view>
                                </view>

                                <view class="dot-right">
                                    <view class="dot-item dot-item-right"></view>
                                    <view class="dot-item dot-item-right"></view>
                                    <view class="dot-item dot-item-right"></view>
                                </view>

                            </view>
                        </view>
                    </view>
                </view>
                <!--折扣信息-->
                <view class="discounts-tags van-hairline--top" wx:if="{{discounts.length}}" bindtap="changeDiscounts">
                    <view class="tags-title">
                        促销
                    </view>
                    <view class="discounts-box">
                        <view class="disconts-item" wx:for="{{discounts}}" wx:key="{{index}}">
                            <view class="discounts-tags-title">
<!--                                {{item.tags}}-->
                                {{item.title}}
                            </view>
                            <view class="tags-item">
<!--                                {{item.label}} -->
                                {{item.intro}}
                            </view>
                        </view>

                    </view>
                </view>
            </view>


        </view>





<!--评价-->

    <view class="wrap-item js__comment" >

        <view class="tui-cmt-box  tui-radius-all">
            <view class="tui-list-cell tui-last tui-between">
                <view class="tui-bold tui-cell-title">评价 ({{detailData.data.comment_count}})</view>
                <view bindtap="goToCommon" data-id="{{detailData.data.id}}">
                    <text class="tui-cmt-all">全部</text>
                    <tui-icon name="more-fill" size="20" color="#C9A063"></tui-icon>
                </view>
            </view>



        </view>

        <view class="content" >
            <view class="comment_list" wx:for="{{detailData.data.oneComment}}" wx:key="{{index}}">
                <view class="comment_user">
                    <view class="img-box">
                        <image src="{{item.user.avatar||ava}}"></image>
                        <view class="user_name">{{item.user.nick_name||'无名氏'}}</view>
                    </view>
                    <view class="rater">
                        <template is="rater" data="{{ ...$vlc.rater.store }}"/>
                    </view>
                </view>
                <view class="comment_time">
                    <view class="time">
                        {{item.updated_at}}
                    </view>
                    <view class="model">
                        {{item.item_meta.specs_text}}
                    </view>
                </view>
                <view class="comment_content">
                    {{item.contents}}
                </view>
                <view class="comment-img" >

                    <image src="{{itemName}}" mode="widthFix" alt="" wx:for="{{item.pic_list}}" wx:key  bindtap="preImge" wx:for-index="idx" wx:for-item="itemName" data-list="{{item.pic_list}}" data-url="{{itemName}}"/>


                </view>


            </view>
        </view>

    </view>






        <!--商品参数-->
        <view class="wrap-item"  wx:if="{{attributesList.top.length}}">
            <div class="title mx-1px-bottom" data-type="parameter" bindtap="change">
                <view class="text f28">
                    作品参数
                </view>
                <div class="icon {{expands.parameter ? 'arrow-up' : 'arrow-down'}}">

                </div>
            </div>
            <view class="content" wx:if="{{expands.parameter}}">
                <view class="argument-box">
                    <view class="argument-top">
                       <span wx:for="{{attributesList.top}}" wx:for-item="top" wx:key="{{index}}">
                           {{top.name}} : {{top.attribute_value}}
                       </span>
                    </view>
                    <view class="argument-bottom" wx:if="{{attributesList.bottom.length}}">
                        <view class="argument-item" wx:for="{{attributesList.bottom}}" wx:key="{{index}}" wx:for-item="bottom">
                            <view class="index-title">{{bottom.name}} ：</view>
                            <view class="index-box">
                                <ul>
                                    <li class="{{bottom.attribute_value_id == list.id ? 'red-dot' : ''}}" wx:for="{{bottom.values}}" wx:key="{{index}}" wx:for-item="list">
                                        {{list.name}}
                                    </li>
                                </ul>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>

        <!--商品详情mx-1px-bottom-->
        <view class="wrap-item commodity">
            <div class="title" data-type="commodity" bindtap="change">
                <view class="tui-bold tui-cell-title">详情</view>
            </div>
            <view class="content" wx:if="{{expands.commodity}}">
                <template is="wxParse" data="{{wxParseData:detailI.nodes}}"/>
            </view>
        </view>







        <!--遮罩层-->
        <view class="maks {{!show_select ? 'cur' : ''}}" bindtap="closeSelect">

        </view>

        <!--选择SKU-->
        <view class="sku-popup" hidden="{{show_select}}" animation="{{show.animation}}">
            <view class="select-goods-container">
                <view class="select-goods-cloese" bindtap="closeSelect"></view>

                <view class="select-goods-header">
                    <view class="img-box">
                        <image wx:if="{{select_product && select_product.img}}" src="{{select_product.img}}"></image>
                        <image wx:else src="{{detailData.data.img}}"></image>
                    </view>
                    <view class="price-box">
                        <view class="price">
                            ￥{{price}}
                        </view>
                        <view class="count">
                            库存{{store_count}}
                        </view>
                    </view>
                </view>
                <view class="select-goods-spec">
                    <!--SKU-->
                    <view class="spec-line" wx:for="{{specs}}" wx:for-item="spec" wx:key="{{index}}">
                        <view class="spec-title">{{spec.label}}</view>
                        <view class="spec-value ">
                            <view  class="spec-block {{ !!item.active ? 'active' : '' }} {{ !!item.disabled ? 'disabled' : '' }}" wx:for="{{spec.values}}" wx:key="{{index}}" data-key="{{index}}" data-index="{{item.index}}" data-disabled="{{item.disabled ? 1 : 0}}" data-id="{{item.id}}" data-active="{{item.active ? 1 : 0}}" bindtap="selectSpec">
                            <span class="spec-text">
                                {{item.alias || item.value}}
                            </span>
                                <!--<span class="spec-text b" wx:if="{{!item.spec_img && !item.color}}">{{item.alias || item.value}}</span>-->
                            </view>
                        </view>
                    </view>

                    <!--数量-->
                    <view class="spec-line">
                        <view class="spec-title">数量</view>
                        <view class="num-value">
                            <span bindtap="changeCount" data-index="0">-</span>
                            <span class="none-border">
                            <input bindinput="modifyCount" value="{{select_count}}"  type="number" confirm-type="done"/>
                        </span>
                            <span bindtap="changeCount" data-index="1">+</span>
                        </view>
                    </view>

                    <button class="button {{ canBuy ? 'disabled' : '' }}" type="primary" loading="{{loading}}" bindtap="confirm">确定</button>
                </view>
            </view>
        </view>


        <!--加入购物车弹出-->
        <view class="cart-box" catchtouchmove="move" hidden="{{!show_cart}}">
            <view class="cart-mask">

            </view>
            <view class="cart-dialog">
                <view class="title mx-1px-bottom">
                    商品成功加入购物车
                </view>
                <view class="buttons">

                    <view class="button agin" bindtap="changeCart">
                        继续购物
                    </view>

                    <view class="button" bindtap="goCart">
                        立即结算
                    </view>

                </view>

            </view>
        </view>

        <!--弹出分享部分-->
        <view class="maks {{show_share ? 'cur' : ''}}">

        </view>

        <view class="share-box {{show_share ? 'cur' : ''}}">
            <button class="shaer-item" open-type="share">
                分享给好友
            </button>
            <view class="shaer-item van-hairline--top" bindtap="getShearImg">
                分享到朋友圈
            </view>
            <view class="shaer-item clear" bindtap="changeShare">
                取消
            </view>
        </view>

        <!--查看选择优惠券部分-->
        <view class="maks {{show_coupons ? 'cur' : ''}}" bindtap="changeCoupons">
        </view>

        <view class="popup-box {{show_coupons ? 'cur' : ''}}">
            <view class="popup">
                <view class="popup-top">
                    <view class="title">
                        优惠券
                        <view class="close" bindtap="changeCoupons">
                            X
                        </view>
                    </view>
                </view>
                <view class="popup-bottom coupon">
                    <view class="title">
                        可领优惠券
                    </view>
                    <view class="coupon-box">
                        <view class="coupon-item" wx:for="{{coupons}}" wx:key="{{index}}">
                            <view class="coupon">
                                <view class="coupon-left">
                                    <view class="text-wrap">
                                        <view class="text-box" >
                                            <view class="text">
                                                <span class="money" wx:if="{{item.action_type.type == 'cash'}}">￥</span>
                                                <span class="num">{{ item.action_type.value }}</span>

                                                <span class="money" wx:if="{{item.action_type.type == 'discount'}}">折</span>
                                            </view>
                                            <span class="label text">{{ item.label }}</span>
                                        </view>

                                    </view>
                                    <view class="dot-wrap">
                                        <view class="dot-item">

                                        </view>
                                        <view class="dot-item">

                                        </view>
                                        <view class="dot-item">

                                        </view>
                                        <view class="dot-item">

                                        </view>
                                        <view class="dot-item">

                                        </view>
                                    </view>
                                </view>
                                <view class="coupon-right">
                                    <view class="top">
                                        <span class="info">{{item.title}}</span>
                                    </view>
                                    <view class="bottom">
                                        <view class="bottom-use">
                                            <view class="tiem-box">
                                                <text>{{item.use_start_time}}至{{item.use_end_time}}</text>
                                            </view>
                                            <view class="btn use" data-id="{{item.id}}" data-index="{{index}}" wx:if="{{!coupons[index].receive}}" bindtap="getCoupon">
                                                点击领取

                                            </view>
                                            <view class="btn already" wx:else>
                                                已领取

                                            </view>

                                        </view>
                                    </view>
                                </view>
                            </view>
                        </view>
                    </view>
                </view>
            </view>
        </view>

        <!--查看促销部分-->
        <view class="maks {{show_discounts ? 'cur' : ''}}" bindtap="changeDiscounts">

        </view>

        <view class="popup-box {{show_discounts ? 'cur' : ''}}">
            <view class="popup">
                <view class="popup-top">
                    <view class="title">
                        促销
                        <view class="close" bindtap="changeDiscounts">
                            X
                        </view>
                    </view>
                </view>

                <view class="popup-bottom discounts">
                    <view class="discounts-box">
                        <view class="disconts-item mx-1px-bottom" wx:for="{{discounts}}" wx:key="{{index}}">
                            <view class="discounts-tags-title">
                                {{item.tags}}
                            </view>
                            <view class="tags-item">
                                {{item.label}}
                            </view>
                        </view>
                    </view>
                </view>

            </view>
        </view>


    </view>




    <!--底部操作栏-->
    <view class="tui-operation">
        <view class="tui-operation-left tui-col-5">

            <view class="tui-operation-item" hover-class="tui-opacity" hover-stay-time="150" bindtap="changeStatus">
                <tui-icon name="like" size="22" color="{{is_Fav?'#C9A063':'#333'}}"></tui-icon>
                <view class="tui-operation-text tui-scale-small">收藏</view>
            </view>
            <view class="tui-operation-item" hover-class="tui-opacity" hover-stay-time="150" bindtap="changeShare">
                <tui-icon name="share" size="22" color='#333'></tui-icon>
                <view class="tui-operation-text tui-scale-small">分享</view>
            </view>
            <view class="tui-operation-item" hover-class="tui-opacity" hover-stay-time="150" data-type="cart" bindtap="jump">
                <tui-icon name="cart" size="22" color='#333'></tui-icon>
                <view class="tui-operation-text tui-scale-small">购物车</view>
<!--                <tui-badge type="red" size="small" tui-badge-class="tui-badge-class">{{cars}}</tui-badge>-->
            </view>
        </view>
        <view class="tui-operation-right tui-right-flex tui-col-7">
            <tui-button type="main" tui-button-class="tui-btn-equals" shape="square" size="mini" class="tui-flex-1" bindtap="showSelect">加入购物车</tui-button>
        </view>
    </view>
    <!--底部操作栏--->

     <!--顶部下拉菜单-->
  <tui-top-dropdown tui-top-dropdown="tui-top-dropdown" bgcolor="rgba(76, 76, 76, 0.95);" show="{{menuShow}}" height="0" bind:close="closeMenu">
    <view class="tui-menu-box tui-padding">
      <view class="tui-menu-header" style="padding-top:{{top}}px;">
        功能直达
      </view>
      <view class="tui-menu-itembox">
        <block wx:for="{{topMenu}}" wx:key="{{index}}">
          <view class="tui-menu-item" hover-class="tui-opcity" hover-stay-time="150" bindtap="clickTop" data-icon="{{item.icon}}">
            <view class="tui-badge-box">
              <tui-icon name="{{item.icon}}" color="#fff" size="{{item.size}}"></tui-icon>
              <tui-badge type="red" tui-badge-class="tui-menu-badge" size="small" wx:if="{{item.badge}}">{{item.badge}}</tui-badge>
            </view>
            <view class="tui-menu-text">{{item.text}}</view>
          </view>
        </block>
      </view>
      <tui-icon name="up" color="#fff" size="26" class="tui-icon-up" catchtap="closeMenu"></tui-icon>
    </view>

  </tui-top-dropdown>
  <!---顶部下拉菜单-->

</view>
